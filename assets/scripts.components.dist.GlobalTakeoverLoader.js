(()=>{"use strict";var e={d:(t,i)=>{for(var s in i)e.o(i,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:i[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{TakeoverLoader:()=>TakeoverLoader});class TakeoverLoader extends HTMLElement{constructor(){super(),this.resetTimeoutContainer=null,this.fetchTimeoutFailsafe=null,this.isAnimatingOut=!1,this.fetchFailsafeDuration=8888,this.isReversing=!1}connectedCallback(){this.resetDelay=parseInt(getComputedStyle(this).getPropertyValue("--takeover-reset-delay"),10)||1500;let e=this.querySelector(":scope > template");e?(this.imageData=JSON.parse(e.innerHTML),void 0===this.imageData.logo&&void 0===this.imageData.background||(this.isTakingOver=!1,this.takeoverRollout=!1,e.remove(),this.setupSVGs(),DomReadyPromise().then((()=>{this.setupListeners()})).catch((e=>console.error(e))))):this.handleError("Template not found",!0)}resetTakeover(){this.classList.remove("active","hiding"),this.takeoverRollout=!1,this.isTakingOver=!1,null!==this.resetTimeoutContainer&&(clearTimeout(this.resetTimeoutContainer),this.resetTimeoutContainer=null)}startTakeover(){this.classList.add("active"),this.isTakingOver=!0,this.isAnimatingOut=!0}finishTakeover(){this.classList.add("hiding"),this.takeoverRollout=!0,this.isAnimatingOut=!0,this.resetTimeoutContainer=setTimeout((()=>{this.isAnimatingOut=!1,this.resetTakeover()}),this.resetDelay)}setupListeners(){const isReversingCheck=e=>{e?this.classList.add("reversing"):this.classList.remove("reversing")},clearFetchTimeoutFailsafe=()=>{this.fetchTimeoutFailsafe&&clearTimeout(this.fetchTimeoutFailsafe)},failSafe=()=>{clearFetchTimeoutFailsafe(),this.fetchTimeoutFailsafe=setTimeout((()=>{console.warn("Timeout reached: Triggering takeoverComplete automatically."),this.finishTakeover()}),this.fetchFailsafeDuration)};document.addEventListener("takeoverFetching",(e=>{this.isReversing=e?.detail?.isReversing||!1,isReversingCheck(this.isReversing),this.startTakeover(),failSafe()})),document.addEventListener("takeoverComplete",(()=>{clearFetchTimeoutFailsafe(),this.finishTakeover()})),this.hasAttribute("data-testing")&&document.addEventListener("keydown",(e=>{"1"===e.key&&(document.dispatchEvent(new CustomEvent("takeoverFetching",{detail:{isReversing:this.isReversing}})),console.info(`Key: ${e.key} | Event: takeoverFetching`)),"2"===e.key&&this.classList.contains("active")&&(document.dispatchEvent(new CustomEvent("takeoverComplete")),console.info(`Key: ${e.key} | Event: takeoverComplete`)),"3"===e.key&&(this.isReversing=!this.isReversing,isReversingCheck(this.isReversing),console.info(`Key: ${e.key} | Event: reversing takeover ${this.isReversing.toString().toUpperCase()}`))}))}async setupSVGs(){const e=this.imageData.logo,t=this.imageData.background;if(void 0!==t)try{const e=await this.fetchSVG(t),i=document.createElement("div");i.classList.add("takeover-background-wrapper"),i.innerHTML=e,this.appendChild(i)}catch(e){console.error("Error loading backgroundUrl: ",e)}if(void 0!==e)try{const t=await this.fetchSVG(e),i=document.createElement("div");i.classList.add("takeover-logo-wrapper"),i.innerHTML=t,this.appendChild(i)}catch(e){console.error("Error loading logoUrl: ",e)}}async fetchSVG(e){const t=await fetch(e);if(!t.ok)throw new Error(`Failed to fetch SVG from ${e}`);return await t.text()}handleError(e,t=!1){if(console.error(e),t)throw new Error(e)}}customElements.define("global-takeover-loader",TakeoverLoader);var i=self;for(var s in t)i[s]=t[s];t.__esModule&&Object.defineProperty(i,"__esModule",{value:!0})})();