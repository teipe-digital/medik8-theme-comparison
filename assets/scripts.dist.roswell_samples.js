(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{RoswellSampler:()=>RoswellSampler});class ObserverLite{constructor(e){if(e=e||{},this.id=Math.floor(999999999999*Math.random()),this.settings=e,e.key){if(window.GlobalObersverLiteInstances=window.GlobalObersverLiteInstances||{},window.GlobalObersverLiteInstances[e.key])return window.GlobalObersverLiteInstances[e.key];window.GlobalObersverLiteInstances[e.key]=this}}once(){return new Promise(((e,t)=>{this.onceDone&&e(this.onceDone);const n=this.subscribe((t=>{t=t||!0,this.onceDone=t,e(t),this.unsubscribe(n)}))}))}setOnce(e){e=e||!0,this.onceDone=e}next(...e){this.onceDone||this.setOnce(...e),this.subject&&this.subject.length&&this.subject.forEach((({callback:t})=>{t(...e)}))}subscribe(e){return this.subject=this.subject||[],e={callback:e,id:Math.floor(1e14+9e14*Math.random())},this.subject.push(e),e}unsubscribe(e){this.subject=this.subject.filter((({id:t})=>t!==e.id))}unsubscribeAll(e){this.subject?.forEach((e=>this.unsubscribe(e))),e&&(this.onceDone=!1)}}class ShopifyUtils{constructor(e){this.money_format=e.money_format||"Â£{{amount}}"}handleize(e){return e.toLowerCase().replace(/[^\w\u00C0-\u024f]+/g,"-").replace(/^-+|-+$/g,"")}parseImgUrl(e,t){const n=e.includes(".png")?"png":"jpg";return`${e.split("png"==n?".png":".jpg")[0]}_${t}x.${n}`}formatMoney(e,t){"string"==typeof e&&(e=e.replace(".",""));var n="",r=/\{\{\s*(\w+)\s*\}\}/,s=t||this.money_format;function defaultOption(e,t){return void 0===e?t:e}function formatWithDelimiters(e,t,n,r){if(t=defaultOption(t,2),n=defaultOption(n,","),r=defaultOption(r,"."),isNaN(e)||null==e)return 0;var s=(e=(e/100).toFixed(t)).split(".");return s[0].replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1"+n)+(s[1]?r+s[1]:"")}switch(s.match(r)[1]){case"amount":n=formatWithDelimiters(e,2);break;case"amount_no_decimals":n=formatWithDelimiters(e,0);break;case"amount_with_comma_separator":n=formatWithDelimiters(e,2,".",",");break;case"amount_no_decimals_with_comma_separator":n=formatWithDelimiters(e,0,".",",")}return s.replace(r,n)}}class GlobalCart{constructor(e){return window.GlobalCartObserver$=window.GlobalCartObserver$||new ObserverLite,window.GlobalCartSingleton?new Promise(((e,t)=>{window.GlobalCartObserver$.loaded?e(window.GlobalCartSingleton):window.GlobalCartObserver$.subscribe((()=>{e(window.GlobalCartSingleton)}))})):e?(window.GlobalCartSingleton=this,this.ObserverLite=new ObserverLite,this.ShopifyUtils=new ShopifyUtils({money_format:e.money_format||!1}),this.subscribe((()=>{window.GlobalCartObserver$.loaded=!0,window.GlobalCartObserver$.next()})),void this.updateData()):new Promise(((e,t)=>{window.GlobalCartObserver$.subscribe((()=>{e(window.GlobalCartSingleton)}))}))}subscribe(e){return this.ObserverLite.subscribe(e)}next(e){this.ObserverLite.next(e)}serialize(e){const t={};function setValue(e,t,n){const r=t.pop();let s=e;for(const e of t)s[e]||(s[e]={}),s=s[e];s[r]=n}const n=new FormData(e);for(let[e,r]of n.entries()){setValue(t,e.split("[").map((e=>e.replace("]",""))),r)}return t}addToCart(e){return new Promise(((t,n)=>{e||n({description:"Sorry, there was a problem with that request"});e.items.filter((({id:e})=>this.getLineItemsByVariantId(e).map((({quantity:e})=>e)).reduce(((e,t)=>e+t),0)>=6)).length&&n({type:"max_six"}),fetch("/cart/add.js",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{if(!e.items)throw e;this.updateData(),t()})).catch((e=>{console.log(e),n(e)}))}))}updateData(){return new Promise(((e,t)=>{this.getCartJSON().then((t=>{this.cart=t,this.next({eventType:"update"}),e()}))}))}updateQty(e,t,n){n=n||[{key:e.key,qty:t}],e?.properties?._bundle_id&&(n=n.concat(this.cart.items.filter((({properties:t})=>t?._bundle_id==e.properties._bundle_id)).map((({key:e})=>({key:e,qty:0}))))),fetch("/cart/update.js",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({updates:n.reduce(((e,t)=>({...e,[t.key]:t.qty})),{})})}).then((e=>e.json())).then((e=>{if(!e.token)throw e;this.cart=e,this.next({eventType:"update"})})).catch((e=>{console.log(e),this.next({eventType:"error",error:e})}))}removeItem(e){fetch(e).then((e=>{this.next({eventType:"update"})}))}getCartJSON(){return new Promise(((e,t)=>{fetch("/cart.js").then((e=>e.json())).then((t=>{e(t)}))}))}getLineItemsByVariantId(e){return e=parseInt(e),this.cart&&this.cart.items?this.cart.items.filter((({variant_id:t})=>t==e)):[]}getLineItemsByProperty(e,t){return this.cart&&this.cart.items?this.cart.items.filter((n=>{let r=n.properties?.[e];return r=!!(null==t&&r||r&&r==t),r})):[]}}class RoswellSampler extends HTMLElement{constructor(){super()}connectedCallback(){(function DomReadyPromise(){return new Promise((function(e,t){"loading"!==document.readyState?e():addEventListener("DOMContentLoaded",(()=>{e()}))}))})().then((async()=>{const e=this.querySelector(":scope > template");if(e)try{this.settings=JSON.parse(e.innerHTML),e.remove()}catch(e){console.log(e)}this.settings||this.remove(),this.GlobalCart=await new GlobalCart,this.bind(),this.mount(),this.onCartUpdate()})).catch((e=>{console.log(e)}))}bind(){this.querySelector(".sample-selector-title").addEventListener("click",(e=>{e.target.nextElementSibling.classList.toggle("hidden"),e.target.parentElement.classList.toggle("accordion-item--open")})),this.querySelectorAll(".js-roswell__removeFromCart").forEach((e=>e.addEventListener("click",(t=>{t.preventDefault;const{id:n}=e.dataset;this.GlobalCart.updateQty(!1,!1,[{key:n,qty:0}])})))),this.GlobalCart.subscribe((({eventType:e})=>{"update"!=!e&&this.onCartUpdate()}))}onCartUpdate(){const{cart:e}=this.GlobalCart,t=this.settings.threshold,n=e.items.reduce(((e,{properties:t})=>t._RoswellSample?++e:e),0),r=this.querySelectorAll(".sample-product"),s=this.settings.max_sample;e.total_price>=t?this.style.display="block":(this.style.display="none",this.removeAllSample()),this.toggleSample(r,n,s),this.updateSampleQuantity(n,s),this.updateSampleButton(r,e.items)}toggleSample(e,t,n){t>=n?e.forEach((e=>{e.querySelector(".btn--full").classList.add("disabled")})):e.forEach((e=>{e.querySelector(".btn--full").classList.remove("disabled")}))}updateSampleQuantity(e,t){let n=this.querySelectorAll(".sample-remain");if(n.length>0){let r="Elige ",s=t-e;r+=s,r+=" Muestra",s>1&&(r+="s"),s>0?n.forEach((e=>e.innerHTML=r)):n.forEach((e=>e.innerHTML=""))}}updateSampleButton(e){const t=this.GlobalCart.cart.items;e.forEach((e=>{e.querySelector(".btn--full")?.classList.remove("hide")})),e.forEach((e=>{e.querySelector(".ajaxcart__qty--remove")?.classList.add("hide")})),e=Array.from(e);t.filter((({properties:e})=>e._RoswellSample)).forEach((t=>{let n=e.filter((e=>e.dataset.id==t.key.split(":")[0]));n.length&&n.forEach((function(e,n){e.querySelector(".btn--full").classList.add("hide");let r=e.querySelector(".ajaxcart__qty--remove");r.classList.remove("hide"),r.dataset.line=n+1,r.dataset.id=t.key}))}))}removeAllSample(){const e=this.GlobalCart.cart.items.filter((({properties:e})=>e._RoswellSample));if(e.length){const t=e.map((({key:e})=>({key:e,qty:0})));this.GlobalCart.updateQty(!1,!1,t)}}mount(){if(!window.RoswellSamplerMounted){const e="\n        <style type=\"text/css\">\n\n          .cart .sample-selector {\n            max-width: 674px; \n          }\n\n          @media all and (max-width: 1024px) {\n            .cart .sample-selector {\n              max-width: 100%; \n            } \n          }\n\n          .sample-selector {\n            padding: 0 20px;\n            background: linear-gradient(180deg, rgba(0, 0, 0, 0.05) 0%, rgba(0, 0, 0, 0) 100%), #FFF; \n          }\n\n          .sample-selector .sample-selector-title {\n            font-family: \"acta_displaymedium\", sans-serif;\n            font-size: 16px;\n            font-weight: 500;\n            line-height: 120%;\n            letter-spacing: 0.8px;\n            padding-top: 20px;\n            padding-bottom: 20px;\n            justify-content: space-between;\n            display: flex;\n            cursor: pointer; \n          }\n\n          .sample-selector .sample-selector-title::after {\n            content: url(\"data:image/svg+xml, %3Csvg xmlns='http://www.w3.org/2000/svg' width='13' height='8' viewBox='0 0 13 8' fill='none'%3E%3Cpath d='M12.0214 7.0179L12.0277 7.01162L12.033 7.00452C12.0841 6.93637 12.125 6.84797 12.125 6.75048C12.125 6.66544 12.0935 6.5631 12.0149 6.4902L6.43632 0.911612L6.34794 0.823223L6.25955 0.911612L0.679117 6.49204C0.536323 6.63484 0.536323 6.87061 0.679117 7.0134C0.821911 7.1562 1.05768 7.1562 1.20048 7.0134L6.34802 1.86587L11.5001 7.0179C11.6428 7.1607 11.8786 7.1607 12.0214 7.0179Z' fill='black' stroke='black' stroke-width='0.25'/%3E%3C/svg%3E\");\n            transform: rotateX(180deg); \n          }\n\n          .sample-selector.accordion-item--open .sample-selector-title {\n            padding-bottom: 0px; \n          }\n\n          .sample-selector.accordion-item--open .sample-selector-title::after {\n            transform: none; \n          }\n\n          .sample-selector .sample-remain {\n            color: #C79A94;\n            font-size: 14px;\n            font-weight: 390;\n            line-height: 150%;\n            flex: 0 0 100%;\n            padding-bottom: 20px; \n          }\n\n          .sample-selector .sample-selector-container {\n            flex: 1;\n            display: flex;\n            overflow-x: auto;\n            overflow-y: hidden;\n            transition: max-height 0.3s ease-out;\n            flex-wrap: wrap;\n            max-height: 1000px; \n          }\n          .sample-selector .sample-selector-container.hidden {\n            max-height: 0; \n          }\n          .sample-selector .sample-selector-container .sample-selector-inner-container {\n            display: flex;\n            justify-content: space-between; \n          }\n          \n          .sample-selector .sample-selector-container .sample-selector-inner-container .sample-product {\n            width: 160px;\n            margin-right: 20px;\n            display: flex;\n            flex-direction: column;\n            justify-content: space-between; \n          }\n          \n          @media all and (max-width: 767px) {\n            .sample-selector .sample-selector-container .sample-selector-inner-container .sample-product {\n              width: 140px; \n            } \n          }\n          \n          .sample-selector .sample-selector-container .sample-selector-inner-container .sample-product:last-child {\n            margin-right: 0; \n          }\n          \n          .sample-selector .sample-selector-container .sample-selector-inner-container .sample-product .sample-title {\n            font-size: 14px;\n            font-weight: 420;\n            line-height: 150%; \n          }\n                \n          .sample-selector .sample-selector-container .sample-selector-inner-container .sample-product .sample-size {\n            color: #666;\n            font-size: 10px;\n            font-weight: 390;\n            line-height: 150%; \n          }\n            \n          .sample-selector .sample-selector-container .sample-selector-inner-container .sample-product .btn--full, .sample-selector .sample-selector-container .sample-selector-inner-container .sample-product .ajaxcart__qty--remove {\n            background: #000;\n            color: #fff;\n            width: 100%;\n            border-radius: 0.25rem;\n            min-height: 3em;\n            line-height: 1.42;\n            font-size: 14px; \n          }\n          \n          .sample-selector .sample-selector-container .sample-selector-inner-container .sample-product .btn--full:hover, .sample-selector .sample-selector-container .sample-selector-inner-container .sample-product .ajaxcart__qty--remove:hover {\n            background: transparent;\n            color: #000 !important; \n          }\n          \n          .sample-selector .sample-selector-container .sample-selector-inner-container .sample-product .btn--full.disabled, .sample-selector .sample-selector-container .sample-selector-inner-container .sample-product .ajaxcart__qty--remove.disabled {\n            color: #666666;\n            background: #A4ACB1;\n            pointer-events: none;\n            border-color: #A4ACB1; \n          }\n          \n          .sample-selector .sample-selector-container .sample-selector-inner-container .sample-product a.btn--full {\n            display: flex;\n            justify-content: center;\n            align-items: center; \n          }\n        \n        </style>\n      ";window.RoswellSamplerMounted=!0,document.body.append(function parseHTML(e){const t=document.createElement("template");return t.innerHTML=e,t.content}(e))}}}customElements.define("roswell-sampler",RoswellSampler);var n=self;for(var r in t)n[r]=t[r];t.__esModule&&Object.defineProperty(n,"__esModule",{value:!0})})();