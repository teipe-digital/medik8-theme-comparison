(()=>{"use strict";var t={d:(e,s)=>{for(var i in s)t.o(s,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:s[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{GlobalFilterSidebar:()=>GlobalFilterSidebar,GlobalProductThumbnail:()=>GlobalProductThumbnail,SearchResultsArticles:()=>SearchResultsArticles,SearchResultsHeading:()=>SearchResultsHeading,SearchResultsNavigation:()=>SearchResultsNavigation,SearchResultsPage:()=>SearchResultsPage,SearchResultsPageHub:()=>SearchResultsPageHub_SearchResultsPageHub,SearchResultsProducts:()=>SearchResultsProducts});class GlobalFilterSidebar extends HTMLElement{constructor(){super(),this.ObserverLite=new ObserverLite}subscribe(t){return this.ObserverLite.subscribe(t)}next(){this.ObserverLite.next()}connectedCallback(){DomReadyPromise().then((async()=>{this.hub=await new SearchResultsPageHub,this.bind()}))}async bind(){await this.hub.ObserverLite.once(),this.sets=this.querySelectorAll(".filter-sidebar__set"),this.checkboxes=this.querySelectorAll('input[type="checkbox"]'),this.reset=this.querySelector(".js-clear-filters"),this.reset?.addEventListener("click",(()=>{this.resetFilters()})),this.checkboxes.forEach((t=>t.addEventListener("change",(()=>{this.update(!0)})))),this.updateStateFromFilters(),this.update()}resetFilters(){this.checkboxes.forEach((t=>{t.checked=!1})),this.update(!0)}updateResetButtonState(){this.reset&&(this.hub.filters["p.tag"]?.length?(this.reset.style.display="block",this.reset.removeAttribute("aria-hidden")):(this.reset.style.display="none",this.reset.setAttribute("aria-hidden","true")))}updateStateFromFilters(){this.querySelectorAll("[value]").forEach((t=>{t.checked=this.hub.filters["p.tag"]?.find((e=>e==t.value))}))}update(t){this.data=this.data||{},this.sets.forEach((t=>{const e=t.dataset.key;this.data[e]=Array.from(t.querySelectorAll('input[type="checkbox"]:checked')).map((t=>t.value))})),t&&this.next(),this.updateResetButtonState()}}customElements.define("global-filter-sidebar",GlobalFilterSidebar);class ShopifyUtils{constructor(t){this.money_format=t.money_format||"Â£{{amount}}"}handleize(t){return t.toLowerCase().replace(/[^\w\u00C0-\u024f]+/g,"-").replace(/^-+|-+$/g,"")}parseImgUrl(t,e){const s=t.includes(".png")?"png":"jpg";return`${t.split("png"==s?".png":".jpg")[0]}_${e}x.${s}`}formatMoney(t,e){"string"==typeof t&&(t=t.replace(".",""));var s="",i=/\{\{\s*(\w+)\s*\}\}/,n=e||this.money_format;function defaultOption(t,e){return void 0===t?e:t}function formatWithDelimiters(t,e,s,i){if(e=defaultOption(e,2),s=defaultOption(s,","),i=defaultOption(i,"."),isNaN(t)||null==t)return 0;var n=(t=(t/100).toFixed(e)).split(".");return n[0].replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1"+s)+(n[1]?i+n[1]:"")}switch(n.match(i)[1]){case"amount":s=formatWithDelimiters(t,2);break;case"amount_no_decimals":s=formatWithDelimiters(t,0);break;case"amount_optional_decimals":s=formatWithDelimiters(t,2),s=Number(s)%1==0?Number(s).toFixed(0):s;break;case"amount_with_comma_separator":s=formatWithDelimiters(t,2,".",",");break;case"amount_with_period_separator":s=formatWithDelimiters(t,2,",",".");break;case"amount_no_decimals_with_comma_separator":s=formatWithDelimiters(t,0,".",",")}return n.replace(i,s)}}class GlobalProductThumbnail extends HTMLElement{constructor(){super(),this.ObserverLite=new ObserverLite;const t=`${window.cartCurrencySymbol}{{amount_optional_decimals}}`;this.ShopifyUtils=new ShopifyUtils({money_format:t})}connectedCallback(){DomReadyPromise().then((async()=>{const t=this.querySelector(":scope > template");if(t)try{this.settings=JSON.parse(t.innerHTML),t.remove()}catch(t){return void this.remove()}this.mount(),this.GlobalCart=await new GlobalCart,this.settings&&(this.innerHTML=await this.getHtmlTemplate()),this.bind()})).catch((t=>{console.error(t)}))}mount(){if(!window.GlobalProductThumbnailMounted){const t='\n        <style type="text/css">\n          global-product-thumbnail{\n            text-align:center;\n          }\n\n          .global-product-thumbnail__img-wrapper{\n            box-shadow:0 3px 15px #0000001a;\n            margin-bottom:10px;\n            position:relative;\n          }\n\n          .global-product-thumbnail__quickview{\n            background: #000;\n            bottom: 24px;\n            color: #fff;\n            font-size: 13px;\n            left: 50%;\n            letter-spacing: 1px;\n            line-height:16px;\n            margin: 0 auto;\n            opacity: 0;\n            pointer-events: none;\n            position: absolute;\n            text-align: center;\n            text-transform: uppercase;\n            transition: .2s ease-in-out;\n            transform:translate(-50%,0%);\n            padding:var(--gutter-unit-d2);\n            min-width:182px;\n            max-width:100%;\n          }\n\n          .global-product-thumbnail__img-wrapper:hover .global-product-thumbnail__quickview{\n            opacity:1;\n            pointer-events: auto;\n          }\n          \n        </style>\n      ';window.GlobalProductThumbnailMounted=!0,document.body.append(parseHTML(t))}}createResponsiveImage({src:t,alt:e,sizes:s,width:i,classList:n}){return`\n      <img \n        srcset="${(s=s||[512,256,128]).map((e=>{return`${t}${s=t,s.includes("?")?"&":"?"}w=${e} ${e}w`;var s})).join(", ")}" \n        alt="${e}"  \n        width="${i}" \n        height="${i}" \n        class="${n}"\n        loading="lazy">\n     `}async buildPrice(t){const e=`<span class='price-v2__${Number(t.objectID)}'>${this.ShopifyUtils.formatMoney(100*t.price)}</span>`;let s=t.compare_at_price?`<s>${this.ShopifyUtils.formatMoney(100*t.compare_at_price)}</s>${e}`:e;return sitewide&&(s=await sitewide.updateGlobalProductPriceV2(t.objectID,s)),s}async buildLabel(t){const e=t.meta?.custom?.badge||null,s=t.compare_at_price?this.settings.translations.compare_label:e;let i=s?`<span class='badge-v2 badge-v2__product-card' aria-label='${s}'>${s}</span>`:"";return sitewide&&(i=await sitewide.updateGlobalProductThumbnailLabelV2(t.objectID,i)),i}async bind(){this.quickViewToggle=this.querySelector("[data-product]"),this.quickViewToggle?.addEventListener("click",(t=>{t.preventDefault(),window.onQuickViewClick(this.quickViewToggle)})),this.yotpoButton=this.querySelector(".js-prod-thumb-yotpo"),this.yotpoButton?.addEventListener("click",(t=>{t.preventDefault();const{handle:e}=this.yotpoButton.dataset;window.location.href=e})),this.ObserverLite.next()}buildReviews(t){return`\n      <div class="yotpo-widget-instance no-events" data-yotpo-instance-id="${window?.yotpoStarsInstanceId}" data-yotpo-product-id="${t.id}" data-yotpo-cart-product-id="" data-yotpo-section-id="${window?.yotpoSectionId}"></div>\n    `}async getHtmlTemplate(){const{product:t}=this.settings,e="Bundles"===t.product_type?`<button class="btn--full btn--outline">\n          <span class="text">${this.settings.translations.view_bundle}</span>\n        </button>`:`<form action="/cart/add" method="post" enctype="multipart/form-data">\n          <input type="hidden" name="id" value="${t.objectID}">\n          <input min="1" type="hidden" name="quantity" value="1" data-variant-id="${t.objectID}" data-variant-inventory-qty="${t.inventory_quantity}">\n          <button class="btn--full btn--outline" onclick="GlobalCartMain.addProductFromButton(event)">\n            <span class="text">${this.settings.translations.add_to_cart}</span>\n          </button>\n        </form>`,s=t.variant_title&&!t.variant_title.includes("Default")&&t.variant_title!=t.title?t.variant_title:t.title;return`\n      <div class="flex flex-grid--d2 column-nowrap justify-space block-fh">\n        <div class="flex flex-grid--d2 column-nowrap grow-1">\n          <span class="global-product-thumbnail__img-wrapper">\n            <a href="/products/${t.handle}?variant=${t.objectID}">\n              <div class="label-wrapper label-wrapper__${t.objectID}" data-type="product-card"\n                aria-label="Label for ${s}">\n                ${await this.buildLabel(t)}\n              </div>\n              ${this.createResponsiveImage({src:t.image,alt:t.title,width:512,classList:"d-block"})}\n            </a>\n            <button class="global-product-thumbnail__quickview @tablet__hide" data-product="/products/${t.handle}?variant=${t.objectID}">\n              ${this.settings.translations.quickview}\n            </button>\n          </span>\n          <a href="/products/${t.handle}?variant=${t.objectID}" class="flex flex-grid--d2 column-nowrap grow-1 justify-space">\n            <span class="t-ucase ls-2 t-rm lh-20">\n              ${s}\n            </span>\n            ${t.meta?.sf_product_hero?.sub_heading?`<span class="ls-1_5 t-grey-1 t-xxxs lh-16">${t.meta.sf_product_hero.sub_heading}</span>`:""}\n          </a>\n        </div>\n        <div class="flex flex-grid--d2 column-nowrap">\n          <span class="ls-1_5 t-xxxs t-grey-1 lh-16">\n            ${await this.buildPrice(t)}\n          </span>\n          <button \n            class="js-prod-thumb-yotpo block-12/12 flex justify-center" \n            data-handle="/products/${t.handle}?variant=${t.objectID}#shopify-section-product-reviews-js">\n            ${this.buildReviews(t)}\n          </button>\n          ${e}\n        </div>\n      </div>\n    `}}customElements.define("global-product-thumbnail",GlobalProductThumbnail);class SearchResultsPageHub_SearchResultsPageHub{constructor(t){const e=new ObserverLite({key:"searchHub$"});if(!t)return new Promise((async(t,s)=>{t(await e.once())}));this.settings=t,this.sort_by=t.sort_by,this.ObserverLite=new ObserverLite,this.agSearch=new AgSearchUtil({app_id:t.app_id,search_api_key:t.search_api_key}),this.results=!1,e.next(this),this.filters=this.getFilterParamsFromUrl(),this.sort_by.current=this.sortParamsFromUrl||this.sort_by.values[0].value,this.search()}subscribe(t){return this.ObserverLite.subscribe(t)}next(){this.ObserverLite.next()}get sortParamsFromUrl(){return new URLSearchParams(window.location.search).get("sort_by")}getFilterParamsFromUrl(){const t=new URLSearchParams(window.location.search),e={};for(const[s,i]of t)if(s.startsWith("filter.")){const t=s.replace("filter.","");if(e[t]){const s=i.split(",").filter((t=>t.length));e[t]=[...new Set([...e[t],...s])]}else{const s=i.split(",").filter((t=>t.length));e[t]=s}}return e}getFilterUrlFromParams(){const t=window.location.href.split("?")[0],e=new URLSearchParams(window.location.search);return Array.from(e.keys()).forEach((t=>{(t.startsWith("filter.")||t.startsWith("sort_by"))&&e.delete(t)})),Object.entries(this.filters).forEach((([t,s])=>{e.set(`filter.${t}`,s.join(","))})),e.set("sort_by",this.sort_by.current),`${t}?${e.toString()}`}search(){const t=new URLSearchParams(window.location.search).get("q");t||this.next();const e=!!this.filters["p.tag"]?.length&&this.filters["p.tag"].map((t=>`tags:${t}`));this.agSearch.search({query:t,indexes:[{indexName:`${this.settings.index_prefix}products`,key:"products",facets:["tags"],facetFilters:[e]||0,attributesToRetrieve:["objectID","title","image","handle","objectID","variant_title","meta","price","compare_at_price","inventory_quantity","id","position","product_type"],hitsPerPage:100},{indexName:`${this.settings.index_prefix}pages`,key:"pages",attributesToRetrieve:["objectID","handle","title","meta"]},{indexName:`${this.settings.index_prefix}articles`,key:"articles",attributesToRetrieve:["objectID","blog","image","handle","title"]}],merge:{indexes:["pages","articles"],key:"articles"}}).then((e=>{this.results=e,this.results.products.hits=this.results.products.hits.map(((t,e)=>(t.index=e,t))),this.terms=t,this.resultsCount=e?.products?.hits?.length||0,this.resultsCount=this.resultsCount+(e?.articles?.hits?.length||0),this.update()})).catch((t=>{this.next(),console.log(t)}))}update(){this.results.products.hits=this.results.products.hits.sort(((t,e)=>{const s=this.sort_by.current;return"relevance"==s?t.index-e.index:"price-ascending"==s?t.price-e.price:"price-descending"!=s||e.price-t.price})),this.next(),document.title=this.settings.title_tag.replace("[[term]]",this.terms).replace("[[count]]",this.resultsCount),history.replaceState(null,"",this.getFilterUrlFromParams())}}class SearchResultsPage extends HTMLElement{constructor(){super()}connectedCallback(){DomReadyPromise().then((async()=>{this.hub=await new SearchResultsPageHub,await this.hub.ObserverLite.once(),this.sections=Array.from(this.querySelectorAll("[data-section-type]")).map((t=>{const{sectionType:e}=t.dataset;return{sectionType:e,element:t}})),this.navigation=this.querySelector("search-results-navigation"),await this.navigation.ObserverLite.once(),this.updateState(),this.navigation.subscribe((()=>{this.updateState()}))}))}updateState(){this.sections.forEach((({sectionType:t,element:e})=>{t==this.navigation.selected?(e.style.display="flex",e.removeAttribute("aria-hidden")):(e.style.display="none",e.setAttribute("aria-hidden",!0))}))}}customElements.define("search-results-page",SearchResultsPage);class SearchResultsHeading extends HTMLElement{constructor(){super()}get headerForResults(){return this.content_with_results.replace("[[count]]",this.hub.resultsCount).replace("[[term]]",this.hub.results.products.query)}connectedCallback(){DomReadyPromise().then((async()=>{if(this.content_no_results=this.getAttribute("content_no_results")||!1,this.content_with_results=this.getAttribute("content_with_results")||!1,!this.content_no_results||!this.content_with_results)return!1;this.hub=await new SearchResultsPageHub,await this.hub.ObserverLite.once(),this.render(),this.hub.subscribe((()=>{this.render()}))}))}render(){this.style.display="block",this.hub.results?this.innerHTML=`<h1 class="h-style t-m f-w600">${this.headerForResults}</h1>`:this.innerHTML=`<h1 class="h-style t-m f-w600">${this.content_no_results}</h1>`}}customElements.define("search-results-heading",SearchResultsHeading);class SearchResultsNavigation extends HTMLElement{constructor(){super(),this.ObserverLite=new ObserverLite}subscribe(t){return this.ObserverLite.subscribe(t)}next(){this.ObserverLite.next()}connectedCallback(){this.mount(),DomReadyPromise().then((async()=>{this.hub=await new SearchResultsPageHub,await this.hub.ObserverLite.once(),this.render(),this.hub.subscribe((()=>{this.render()}))}))}mount(){if(!window.SearchResultsNavigationMounted){const t='\n        <style type="text/css">\n          .search-res-nav__button{\n            flex-grow:1;\n            height:50px;\n            display:flex;\n            align-items:center;\n            justify-content:center;\n            border-bottom:4px solid #aaa;\n            text-transform:uppercase;\n            font-size:var(--t-xs);\n            padding:0 var(--gutter-unit-d2);\n            position:relative;\n          }\n\n          .search-res-nav__button:not(:last-child):after{\n            content:\'\';\n            width:1px;\n            height:30px;\n            right:0;\n            top:0;\n            background:#ccc;\n            position:absolute;\n          }\n\n          .search-res-nav__button[data-nav-active="true"]{\n            border-color:#000;\n            font-weight:600;\n          }\n        </style>\n      ';window.SearchResultsNavigationMounted=!0,document.body.append(parseHTML(t))}}render(){this.innerHTML="";let t=this.hub?.results?.articles?.hits?.length||0,e=this.hub?.results?.products?.hits?.length||0;const{translations:s}=this.hub.settings;this.selected="products",this.innerHTML=`\n      <div class="flex row-wrap align-center justify-center cell-l cell-r">\n        <button class="search-res-nav__button btn-reset" data-nav-type="products">${s.navigation.products} (${e})</button>\n        <button class="search-res-nav__button btn-reset" data-nav-type="articles">${s.navigation.articles} (${t})</button>\n      </div>\n    `,this.updateButtonState(),this.bind(),this.next()}updateButtonState(){this.querySelectorAll("[data-nav-type]").forEach((t=>{const{navType:e}=t.dataset;t.dataset.navActive=this.selected==e}))}bind(){this.querySelectorAll("[data-nav-type]").forEach((t=>{t.addEventListener("click",(()=>{const{navType:e}=t.dataset;this.selected=e,this.updateButtonState(),this.next()}))}))}}customElements.define("search-results-navigation",SearchResultsNavigation);class SearchResultsArticles extends HTMLElement{constructor(){super()}connectedCallback(){DomReadyPromise().then((async()=>{this.mount(),this.hub=await new SearchResultsPageHub,await this.hub.ObserverLite.once(),this.agSearchInsightsUtil=await new AgSearchInsightsUtil,this.render(),this.hub.subscribe((()=>{this.render()}))}))}render(){if(this.hub?.results?.articles?.hits?.length)this.innerHTML=this.getHtmlTemplate(),this.items=this.querySelectorAll("a[data-ag_index]"),this.items.forEach((t=>{t.addEventListener("click",(e=>{const{ag_index:s,ag_object_id:i}=t.dataset;this.agSearchInsightsUtil.sendItemClickEvent({index:s,objectIDs:[i]})}))}));else{const{translations:t}=this.hub.settings;this.innerHTML=`<p class="tac ct--x4 cb--x4">${t.articles.empty}</p>`}}mount(){if(!window.SearchResultsArticlesMounted){const t='\n        <style type="text/css">\n          .search-res-article__image{\n            width:128px;\n            height:128px;\n            object-fit:cover;\n          }\n\n          .search-res-article__content{\n            width:calc(100% - 128px - var(--gutter-unit-d2));\n          }\n        </style>\n      ';window.SearchResultsArticlesMounted=!0,document.body.append(parseHTML(t))}}getHtmlTemplate(){const{articles:t}=this.hub.results,{translations:e}=this.hub.settings;return`\n      <div class="flex row-wrap align-stretch justify-left flex-grid-y cell-l--d2 cell-r--d2">\n        ${t.hits.map((t=>{const s=t.blog?`/blogs/${t.blog.handle}/${t.handle}`:`/pages/${t.handle}`,i=t.image?`${t.image}&w=128&height=128`:t.meta?.custom?.thumbnail_image_url?`${t.meta?.custom?.thumbnail_image_url}&w=128&height=128`:`${this.hub.settings.placeholder_image}&w=128&height=128`;return`\n              <a href="${s}" \n                 data-ag_index="${t.agSearchIndexName}"\n                 data-ag_object_id="${t.objectID}"\n                 class="cell-l--d2 cell-r--d2 flex row-wrap align-center justify-space block-6/12 @mobile__block-12/12">\n                <img \n                  class="search-res-article__image" \n                  loading="lazy" \n                  src="${i}">\n                <div class="search-res-article__content flex column-nowrap flex-grid-y--d3">\n                  <span>${t.title}</span>\n                  <span class="f-w600"><u>${e.articles.thumbnail.read_more}</u></span>\n                </div>\n              </a>\n            `})).join("")}\n      </div>\n    `}}customElements.define("search-results-articles",SearchResultsArticles);class SearchResultsProducts extends HTMLElement{constructor(){super(),this.filterToggle$=new ObserverLite}connectedCallback(){DomReadyPromise().then((async()=>{this.hub=await new SearchResultsPageHub,await this.hub.ObserverLite.once(),this.agSearchInsightsUtil=await new AgSearchInsightsUtil,this.render(),this.hub.subscribe((()=>{this.render()}))}))}render(){this.innerHTML=this.getHtmlTemplate(),this.bind()}async bind(){this.querySelector(".js-mobile-filters-toggle").addEventListener("click",(t=>{t.preventDefault(),this.filterToggle$.next()})),this.sort_by=this.querySelector(".js-sort-by"),this.sort_by.addEventListener("change",(t=>{this.hub.sort_by.current=this.sort_by.value,this.hub.update()}));const t=Array.from(this.querySelectorAll("global-product-thumbnail")).map((t=>t.ObserverLite.once()));await Promise.all(t),window.yotpoWidgetsContainer&&window.yotpoWidgetsContainer.initWidgets(),this.items=this.querySelectorAll("global-product-thumbnail"),this.items.forEach((t=>{t.addEventListener("click",(e=>{const{ag_index:s,ag_object_id:i}=t.dataset;this.agSearchInsightsUtil.sendItemClickEvent({index:s,objectIDs:[i]})}))}))}getHtmlTemplate(){const{products:t}=this.hub.results,{translations:e,sort_by:s}=this.hub.settings,i=this.hub.filters["p.tag"]?.length||0,n=t.hits.length>1?e.products.product_plural:e.products.products_single;return`\n      <div class="flex flex-grid-y--d2 row-wrap align-top justify-space row cell-l--d2 cell-r--d2 @tablet__align-center">\n        <span class="cell-l--d2 cell-r--d2 @tablet__hide">${t.hits.length} ${n}</span>\n        <div class="cell-l--d2 cell-r--d2 @tablet__block-7/12">\n          <div class="gbl-styled-select block-12/12">\n            <label class="gbl-styled-select__label">${s.label}:</label>\n            <select class="js-sort-by gbl-styled-select__select" name="SortBy">\n              ${s.values.map((({value:t,label:e})=>`<option value="${t}" ${this.hub.sort_by.current==t?'selected="selected"':""}>${e}</option>`)).join("")}\n            </select>\n          </div>\n        </div>\n        <div class="cell-l--d2 cell-r--d2 block-5/12 @tablet__show @tablet__cell-l--none">\n          <button class="js-mobile-filters-toggle gbl-filter-toggle-btn block-12/12">\n            <i class="wayfx-icon wayfx-icon-filter"></i>\n            <span>Filters${i?` (${i})`:""}</span>\n          </button>\n        </div>\n      </div>\n      ${this.hub?.results?.products?.hits?.length?`\n          <div class="flex row-wrap align-stretch justify-left flex-grid-y cell-l--d2 cell-r--d2">\n            ${t.hits.map((t=>(delete t._highlightResult,delete t._snippetResult,`\n                  <global-product-thumbnail \n                    class="d-block block-4/12 cell-l--d2 cell-r--d2 @tablet__block-6/12"\n                    data-ag_index="${t.agSearchIndexName}"\n                    data-ag_object_id="${t.objectID}">\n                    <template>\n                      {\n                        "type":"ag",\n                        "product":${JSON.stringify(t)},\n                        "translations":{\n                          "quickview":"${e.products.thumbnail.quickview}",\n                          "add_to_cart":"${e.products.thumbnail.add_to_cart}",\n                          "compare_label":"${e.products.thumbnail.compare_label}",\n                          "view_bundle":"${e.products.thumbnail.view_bundle}"\n                        }\n                      }\n                    </template>\n                  </global-product-thumbnail>\n                `))).join("")}\n          </div>\n          `:`<p class="tac ct--x4 cb--x4">${e.products.empty}</p>`}\n    `}}customElements.define("search-results-products",SearchResultsProducts);var s=self;for(var i in e)s[i]=e[i];e.__esModule&&Object.defineProperty(s,"__esModule",{value:!0})})();