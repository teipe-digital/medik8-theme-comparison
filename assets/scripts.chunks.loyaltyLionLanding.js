(()=>{"use strict";var e={d:(t,s)=>{for(var n in s)e.o(s,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:s[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{LoyaltyLionUtil:()=>LoyaltyLionUtil});class ObserverLite{constructor(e){if(e=e||{},this.id=Math.floor(999999999999*Math.random()),this.settings=e,e.key){if(window.GlobalObersverLiteInstances=window.GlobalObersverLiteInstances||{},window.GlobalObersverLiteInstances[e.key])return window.GlobalObersverLiteInstances[e.key];window.GlobalObersverLiteInstances[e.key]=this}}once(){return new Promise(((e,t)=>{this.onceDone&&e(this.onceDone);const s=this.subscribe((t=>{t=t||!0,this.onceDone=t,e(t),this.unsubscribe(s)}))}))}setOnce(e){e=e||!0,this.onceDone=e}next(...e){this.onceDone||this.setOnce(...e),this.subject&&this.subject.length&&this.subject.forEach((({callback:t})=>{t(...e)}))}subscribe(e){return this.subject=this.subject||[],e={callback:e,id:Math.floor(1e14+9e14*Math.random())},this.subject.push(e),e}unsubscribe(e){this.subject=this.subject.filter((({id:t})=>t!==e.id))}unsubscribeAll(e){this.subject?.forEach((e=>this.unsubscribe(e))),e&&(this.onceDone=!1)}}function parseHTML(e){const t=document.createElement("template");return t.innerHTML=e,t.content}class TrapFocusLite{constructor(e){this.ObserverLite=new ObserverLite,this.element=e,this.element.addEventListener("keydown",(e=>{this.keyDownHandler(e)}))}subscribe(e){return this.ObserverLite.subscribe(e)}next(e){this.ObserverLite.next(e)}setAttributes(e,t){for(let s in t)e.setAttribute(s,t[s])}removeAttributes(e,t){t.forEach((t=>{e.removeAttribute(t)}))}get focusables(){return this.element.querySelectorAll('a[href]:not([disabled]), button:not([disabled]), textarea:not([disabled]), input[type="text"]:not([disabled]), input[type="radio"]:not([disabled]), input[type="checkbox"]:not([disabled]), select:not([disabled])')}setFocus(){this.lastFocusedElement=document.activeElement,this.focusables[0].focus()}resetFocus(){this.lastFocusedElement.focus()}keyDownHandler(e){const t=this.focusables,s=t[0],n=t[t.length-1];"Tab"===e.key||9===e.keyCode?e.shiftKey?document.activeElement===s&&(e.preventDefault(),n.focus()):document.activeElement===n&&(e.preventDefault(),s.focus()):this.next({key:e.key})}}class ModalBox{constructor({content:e,settings:t}){window.ModalBoxInstance&&window.ModalBoxInstance.close(),window.ModalBoxInstance=this,this.content=e,this.settings=t||{containerCloseButton:!0},this.ObserverLite=new ObserverLite}subscribe(e){return this.ObserverLite.subscribe(e)}next(e){this.ObserverLite.next(e)}toggle(){this.active?this.close():this.open()}open(){return this.active=!0,this.next({type:"open"}),new Promise(((e,t)=>{if(!this.wrapper){let e=`<div class="modal-wrapper ${this.settings.wrapperClass?this.settings.wrapperClass:""}"\n                            style="${this.settings.wrapperStyles?this.settings.wrapperStyles:""}">\n                         <div class="modal-mask modal-close"></div>\n                         <div class="modal-flex">\n                           <div class="modal-content  \n                                       ${this.settings.contentClass?`${this.settings.contentClass}`:""}\n                                       ${this.settings.overlayClose?"modal-close":""}">\n                              ${this.settings.containerCloseButton?'<button aria-label="close" class="modal-close modal-close-btn btn-reset"></button>':""}\n                           </div>\n                         </div>\n                       </div>`;e=parseHTML(e),this.wrapper=e.querySelector(".modal-wrapper"),this.wrapper.style.opacity=0,this.mask=e.querySelector(".modal-mask"),this.content=parseHTML(this.content),this.contentWrapper=e.querySelector(".modal-content"),this.contentWrapper.style.opacity=0,this.contentWrapper.appendChild(this.content),e.querySelectorAll(".modal-close").forEach((e=>{e.addEventListener("click",(e=>{e.preventDefault(),this.close()}))})),document.body.appendChild(e),this.TrapFocusLite=new TrapFocusLite(this.wrapper),this.TrapFocusLite.subscribe((({key:e})=>{"Escape"==e&&this.close()}))}window.innerWidth,document.body.clientWidth;document.body.classList.add("body-masked"),this.wrapper.style.display="block",this.wrapper.animate([{opacity:0},{opacity:1}],300).onfinish=e=>{e.target.effect.target.style.opacity=1},this.contentWrapper.animate([{transform:"translateY(100px)",opacity:0},{transform:"translateY(0px)",opacity:1}],300).onfinish=t=>{t.target.effect.target.style.transform="translateY(0px)",t.target.effect.target.style.opacity=1,this.TrapFocusLite.setFocus(),this.TrapFocusLite.setAttributes(this.wrapper,{role:"dialog","aria-modal":"true","aria-live":"assertive"}),this.TrapFocusLite.removeAttributes(this.wrapper,["aria-hidden"]),this.next({type:"open:rendered"}),e()}}))}close(){this.active=!1,this.next({type:"close"}),this.wrapper.animate([{opacity:1},{opacity:0}],200).onfinish=e=>{e.target.effect.target.style.opacity=0,document.body.classList.remove("body-masked"),document.body.style.paddingRight="0px",this.wrapper.style.display="none"},this.contentWrapper.animate([{transform:"scale(1)",opacity:1},{transform:"scale(1.2)",opacity:0}],200).onfinish=e=>{e.target.effect.target.style.opacity=0,this.TrapFocusLite.resetFocus(),this.TrapFocusLite.removeAttributes(this.wrapper,["role","aria-modal","aria-live"]),this.TrapFocusLite.setAttributes(this.wrapper,{"aria-hidden":"true"}),this.next({type:"close:finish"})}}destroy(){this.wrapper.remove()}}class LoyaltyLionUtil{constructor(e){return window.LoyaltyLionUtilObserver$=window.LoyaltyLionUtilObserver$||new ObserverLite,new Promise(((t,s)=>{window.LoyaltyLionUtilSingleton?window.LoyaltyLionUtilObserver$.loaded?t(window.LoyaltyLionUtilSingleton):window.LoyaltyLionUtilObserver$.subscribe((()=>{t(window.LoyaltyLionUtilSingleton)})):e?(window.LoyaltyLionUtilSingleton=this,this.settings=e,this.ObserverLite=new ObserverLite,this.subscribe((()=>{window.LoyaltyLionUtilObserver$.loaded=!0,window.LoyaltyLionUtilObserver$.next()})),this.loadAPIPromise().then((()=>{window.loyaltylion._customer=window.loyaltylion.customer,this.loyaltylion=window.loyaltylion,t(window.LoyaltyLionUtilSingleton),this.next()}))):window.LoyaltyLionUtilObserver$.subscribe((()=>{t(window.LoyaltyLionUtilSingleton)}))}))}subscribe(e){return this.ObserverLite.subscribe(e)}next(e){this.ObserverLite.next(e)}loadAPIPromise(){return new Promise(((e,t)=>{window.loyaltylion.ui?e():window.loyaltylion.on("ready",(()=>{e()}))}))}get rewards(){const{program:e,_customer:t}=this.loyaltylion;let s=JSON.parse(JSON.stringify(e.rewards)).filter((({discount_type:e,kind:t})=>"flat"==e&&"cart_discount_voucher"==t));if(s.unshift({discount_amount:0,point_cost:0}),s=s.map((e=>(e.point_cost=10*e.discount_amount,e.active=!!t&&t.pointsRedeemable>=e.point_cost,e))).sort(((e,t)=>e.point_cost-t.point_cost)),t){const e=s.filter((({active:e})=>e)).length-1;e>=0&&(s[e].current=!0)}return s}addOneYearToDate(e){const t=new Date(e);t.setFullYear(t.getFullYear()+1);return`${t.getDate().toString().padStart(2,"0")}/${(t.getMonth()+1).toString().padStart(2,"0")}/${t.getFullYear()}`}showReward(e){e=parseInt(e);const t=this.loyaltylion.customer.claimedRewards.find((({id:t})=>t==e));const s=new ModalBox({content:`\n        <div class="ll-modal-content tac bg-white flex flex-grid column-nowrap align-center justify-center">\n          <h2 class="h-style h-style--accent t-xl">Get Your Code?</h2>\n          <div class="rte-content lh-r t-m">\n            <p>Copy the code by clicking on the button below. You can view your reward vouchers at any time from ‘Your Available Awards’ section on this page. </p>\n          </div>\n          <div class="ll-modal-content__code">${t.redeemable.code}</div>\n          <button data-code="${t.redeemable.code}"\n                  class="js-copy-code-btn btn btn--large">Copy Code</button>\n        </div>\n      `});s.subscribe((({type:e})=>{"open:rendered"==e&&s.wrapper.querySelector(".js-copy-code-btn").addEventListener("click",(e=>{e.preventDefault();const t=e.currentTarget,s=t.innerText;t.innerText="Copied",navigator.clipboard.writeText(t.dataset.code),setTimeout((()=>{t.innerText=s}),2e3)}))})),s.open()}claimReward(e){return new Promise(((t,s)=>{e=parseInt(e);const n=this.loyaltylion.program.rewards.find((({id:t})=>t==e));console.log("reward",n);let i="Swap {{points}} points for this rewards voucher? We recommend converting your points into a reward voucher once you’re ready to make a purchase.";i=i.replace("{{points}}",n.point_cost);let o="{{min_spend}} minimum spend after reward voucher has been applied";o=o.replace("{{min_spend}}",`${this.settings.currencySymbol}${n.minimum_spend-n.discount_amount}`);const r=new ModalBox({content:`\n          <div class="ll-modal-content tac bg-white flex flex-grid column-nowrap align-center justify-center">\n            <h2 class="h-style h-style--accent t-xl">${n.title}</h2>\n            <div class="rte-content lh-r t-m">\n              <p>${i}</p>\n              <p class="t-s">${o}</p>\n            </div>\n            <button class="js-confirm-claim-btn btn btn--large">Redeem Points</button>\n          </div>\n        `});r.subscribe((({type:n})=>{"open:rendered"==n&&r.wrapper.querySelector(".js-confirm-claim-btn").addEventListener("click",(n=>{n.preventDefault(),n.currentTarget.classList.add("btn--loading");const{api:i}=this.loyaltylion,o={method:"POST",headers:{...i.http.headers,"Content-Type":"application/json"},body:JSON.stringify({reward_id:e})};fetch(`${i.http.baseUrl}/v2/rewards/claim`,o).then((e=>e.json())).then((e=>{const{action:s,claimedReward:n}=e,{pointsApproved:i,pointsTotal:o,pointsSpent:r}=e.customer;this.loyaltylion._customer.actions.unshift(s),this.loyaltylion._customer.claimedRewards.unshift(n),this.loyaltylion._customer={...this.loyaltylion.customer,pointsRedeemable:i,pointsTotal:o,pointsSpent:r},t(n),this.next()})).catch((e=>{console.log(e),s(e)}))})),"close:finish"==n&&r.destroy()})),r.open()}))}}var s=self;for(var n in t)s[n]=t[n];t.__esModule&&Object.defineProperty(s,"__esModule",{value:!0})})();