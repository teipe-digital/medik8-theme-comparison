{% schema %}
{
  "name": "Product Comparison",
  "class": "product-comparison-section",
  "settings": [
    {
      "type": "color",
      "id": "section_bg_color",
      "label": "Background Color",
      "default": "#f7f7f7"
    },
    {
      "type": "product",
      "id": "product_1",
      "label": "First Product"
    },
    {
      "type": "product",
      "id": "product_2",
      "label": "Second Product"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Section Heading",
      "default": "Product Comparison"
    }
  ],
  "presets": [
    {
      "name": "Product Comparison",
      "category": "Product",
      "settings": {}
    }
  ]
}
{% endschema %}

<section class="product-comparison-container" style="background: {{ section.settings.section_bg_color }}">
  <div class="block-grid block-grid--index cell-l cell-r flex column-nowrap gap--d2 lh-s tac">
    <h2 class="h-style t-lxl @mobile__t-l">{{ section.settings.heading }}</h2>
  </div>

  <div class="carousel-wrapper block-grid block-grid--index">
    <div class="items global-carousel__items">
      <div class="product-comparison-grid global-carousel__container" style="justify-content: center;">
        <div class="comparison-col title">
          <div class="col-product"></div>
          <div class="col-content concerns title">Concerns</div>
          <div class="col-content types title">Skin Types</div>
          <div class="col-content benefits title">Benefits</div>
          <div class="col-content ingredients title">Key Ingredients</div>
        </div>

        {% assign products = section.settings.product_1 | default: blank %}
        {% if section.settings.product_2 %}
          {% assign products = products | append: ',' | append: section.settings.product_2 %}
        {% endif %}

        {% for product_handle in products %}
          {% assign product = all_products[product_handle] %}
          {% if product != blank %}
          <div class="comparison-col">
            <div class="col-product">
              <div class="col-product-image">
                {% if product.featured_image %}
                  <img src="{{ product.featured_image | img_url: '512x512' }}" alt="{{ product.title }}" width="512" height="512">
                {% endif %}
              </div>
              <span class="col-product-title f-w400">{{ product.title }}</span>
              <form method="post" action="/cart/add">
                <input type="hidden" name="id" value="{{ product.variants.first.id }}">
                <button type="submit" class="comparison-add-btn btn btn--full btn--outline">
                  <span class="bag-text">Add to Bag</span>
                  <div class="price-wrapper">{{ product.price | money }}</div>
                </button>
              </form>
            </div>
            <div class="col-content concerns">{{ product.metafields.custom.concerns }}</div>
            <div class="col-content types">{{ product.metafields.custom.skin_types }}</div>
            <div class="col-content benefits">{{ product.metafields.custom.benefits }}</div>
            <div class="col-content ingredients">{{ product.metafields.custom.ingredients }}</div>
          </div>
          {% endif %}
        {% endfor %}
      </div>
    </div>
  </div>
</section>
