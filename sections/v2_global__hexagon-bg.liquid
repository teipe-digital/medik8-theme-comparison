{% capture desktop_urls %}
  {% for block in section.blocks %}
    url({{block.settings.desktop_image | image_url}}){% unless forloop.last %},{% endunless %}
  {% endfor %}
{% endcapture %}

{% capture mobile_urls %}
  {% for block in section.blocks %}
    url({{block.settings.mobile_image | image_url}}){% unless forloop.last %},{% endunless %}
  {% endfor %}
{% endcapture %}

{% capture desktop_positions %}
  {% for block in section.blocks %}
    {{ block.settings.desktop_x_position }} {{ block.settings.desktop_y_position }}{% unless forloop.last  %},{% endunless %}
  {% endfor %}
{% endcapture %}

{% capture mobile_positions %}
  {% for block in section.blocks %}
    {{ block.settings.mobile_x_position }} {{ block.settings.mobile_y_position }}{% unless forloop.last  %},{% endunless %}
  {% endfor %}
{% endcapture %}

{% capture desktop_repeats %}
  {% for block in section.blocks %}
  {{ block.settings.desktop_repeat }}{% unless forloop.last %},{%endunless%}
  {% endfor %}
{% endcapture %}

{% capture mobile_repeats %}
  {% for block in section.blocks %}
  {{ block.settings.mobile_repeat }}{% unless forloop.last %},{%endunless%}
  {% endfor %}
{% endcapture %}

<style>
  body {
    background-image: {{mobile_urls}};
    background-position: {{mobile_positions}};
    background-repeat: {{mobile_repeats}};
  }

  @media screen and (min-width: 768px) {
    body {
      background-image: {{ desktop_urls }};
      background-position: {{ desktop_positions }};
      background-repeat: {{ desktop_repeats }};
    }
  }
</style>

{%  schema  %}  
  {
    "name": "Repeated Background",
    "presets": [
      {
        "name": "V2/GBL/Repeated-BG"
      }
    ],
    "tag": "section",
    "blocks": [
      {
        "type": "background",
        "name": "Background",
        "settings": [
          {
            "type": "text",
            "id": "title",
            "label": "Title",
            "info": "This is the name that will appear under the section"
          },
          {
            "type": "header",
            "content": "Image Settings"
          },
          {
            "type": "image_picker",
            "id": "desktop_image",
            "label": "Desktop Background Image"
          },
          {
            "type": "image_picker",
            "id": "mobile_image",
            "label": "Mobile Background Image"
          },
          {
            "type": "header",
            "content": "Repeat Settings"
          },
          {
            "type": "select",
            "id": "desktop_repeat",
            "label": "Background Repeat Setting - Desktop",
            "info": "Handles how the background is repeated, x vertically, y horizontal",
             "options": [
              {
                "value": "repeat-x",
                "label": "repeat-x"
              },
              {
                "value": "repeat-y",
                "label": "repeat-y"
              },
              {
                "value": "repeat",
                "label": "repeat"
              },
              {
                "value": "no-repeat",
                "label": "no-repeat"
              }
             ]
          },
          {
            "type": "select",
            "id": "mobile_repeat",
            "label": "Background Repeat Setting - Mobile",
            "info": "Handles how the background is repeated, x vertically, y horizontal",
             "options": [
              {
                "value": "repeat-x",
                "label": "repeat-x"
              },
              {
                "value": "repeat-y",
                "label": "repeat-y"
              },
              {
                "value": "repeat",
                "label": "repeat"
              },
              {
                "value": "no-repeat",
                "label": "no-repeat"
              }
             ]
          },
          {
            "type": "header",
            "content": "Position Settings"
          },
          {
            "type": "select",
            "id": "desktop_x_position",
            "label": "Desktop Horizontal Position",
            "options": [
              {
                "value": "left",
                "label": "Left"
              },
              {
                "value": "center",
                "label": "Center"
              },
              {
                "value": "right",
                "label": "Right"
              }
            ]
          },
          {
            "type": "select",
            "id": "desktop_y_position",
            "label": "Desktop Vertical Position",
            "options": [
              {
                "value": "top",
                "label": "Top"
              },
              {
                "value": "center",
                "label": "Center"
              },
              {
                "value": "bottom",
                "label": "Bottom"
              }
            ]
          },
          {
            "type": "select",
            "id": "mobile_x_position",
            "label": "Mobile Horizontal Position",
            "options": [
              {
                "value": "left",
                "label": "Left"
              },
              {
                "value": "center",
                "label": "Center"
              },
              {
                "value": "right",
                "label": "Right"
              }
            ]
          },
          {
            "type": "select",
            "id": "mobile_y_position",
            "label": "Mobile Vertical Position",
            "options": [
              {
                "value": "top",
                "label": "Top"
              },
              {
                "value": "center",
                "label": "Center"
              },
              {
                "value": "bottom",
                "label": "Bottom"
              }
            ]
          }
        ]
      }
    ]  
  }
{% endschema %}